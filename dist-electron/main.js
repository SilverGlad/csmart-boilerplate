"use strict";const{app:a,BrowserWindow:l}=require("electron"),i=require("path"),u=require("electron-is-dev"),E=process.env.VITE_DEV_SERVER_URL,o=require("sqlite3").verbose(),w=new o.Database("./database.db"),{ipcMain:d}=require("electron");w.close();function c(){const e=new l({width:800,height:600,webPreferences:{preload:i.join(__dirname,"preload.js"),nodeIntegration:!0,contextIsolation:!1}});u?(e.loadURL(E),e.webContents.openDevTools()):e.loadFile(i.join(__dirname,"../../dist/renderer/index.html"))}a.on("ready",()=>{c();const e=new o.Database("./database.db");e.serialize(()=>{e.run("CREATE TABLE IF NOT EXISTS users (id INT, name TEXT)")}),e.serialize(()=>{const s=e.prepare("INSERT INTO users VALUES (?, ?)");s.run(1,"Nicolas Lima"),s.finalize()}),d.on("fetch-users",(s,r)=>{e.all("SELECT id, name FROM users",[],(n,t)=>{if(n)throw n;s.reply("fetch-users-reply",t)})})});a.on("window-all-closed",()=>{process.platform!=="darwin"&&a.quit()});a.on("activate",()=>{l.getAllWindows().length===0&&c()});d.on("fetch-users",(e,s)=>{const r=new o.Database("./database.db");r.all("SELECT id, name FROM users",[],(n,t)=>{if(n)throw n;e.reply("fetch-users-reply",t)}),r.close()});
